<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>anchr :: dynamic inline page anchors</title>
        <!-- <link rel="stylesheet" href="css/style.css"> -->
        <style>
			p {

				-webkit-transition: background-color .5s ease;
				   -moz-transition: background-color .5s ease;
				    -ms-transition: background-color .5s ease;
				     -o-transition: background-color .5s ease;
				        transition: background-color .5s ease;
			}

			.s-highlight {

				background-color: hsla(210, 45%, 80%, .5);
			}
        </style>
    </head>
    <body>

    	<h1>Header</h1>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

		<h2 id="thing">Sub Header</h2>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

    	<p class="mint">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

		<h2>Sub Header 2</h2>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>

    	<p class="hash">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
			tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
			quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
			consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
			cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
			proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</p>


        <script>

        	/**
        	 * Outline
        	 *
        	 * Hashed URL scrolls to element - done
        	 * Highlight said element - done
        	 *
        	 * Hovering over element shows link element
        	 * clicking link element opens url and highlights text
        	 * 
        	 * 
        	 */
        	
        	var elements = ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'ul', 'ol', 'blockquote'],
        		container = document.querySelectorAll('body')[0];

        	function getElements () {
        		var containerEls = [];
        		for (var el in elements) {
        			var els = container.querySelectorAll(elements[el]);
        			if (els.length > 0) {
        				for (var e in els) {
        					if (typeof(els[e]) === 'object') {
			        			containerEls.push(els[e]);
			        		}
		        		}
	        		}
        		}
    			return containerEls;
        	}

        	function position(el) {
        		var top = 0,
        			left = 0,
        			ele = el;

    			while (ele.tagName != "BODY") {
    				top += ele.offsetTop;
    				left += ele.offsetLeft;
    				ele = ele.offsetParent;
    			}

    			return { top : top, left : left };
        	}

        	function hasClass(ele,cls) {
				return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
			}

        	function addClass(ele, cls) {
        		if (!hasClass(ele,cls)) ele.className += " "+cls;
        	}

			function removeClass(ele,cls) {
				if (hasClass(ele,cls)) {
					var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
					ele.className=ele.className.replace(reg,' ');
				}
			}

        	function highlight(el) {
        		addClass(el, 's-highlight');
        		window.setTimeout(function () {
        			removeClass(el, 's-highlight')
        		}, 2000);
        	}

        	function hasDefault () {
        		var hash = window.location.hash.slice(1, window.location.hash.length),
        			el = document.getElementById(hash) ? true :
        			 	 document.getElementsByName(hash) ? true : false;

        		return el;
        	}

        	function scroll() {
        		if(window.location.hash) {
        			var hash = window.location.hash,
        				i = 0,
        				els,
        				el;

    				if (hash.indexOf('[') > -1 && hash.indexOf(']') > -1) {
    					i = hash.slice(hash.indexOf('[') + 1, hash.indexOf(']')) - 1;
    					hash = hash.slice(0, hash.indexOf('['));
    				}

        			if (!hasDefault()) {
        				hash = hash.slice(1, hash.length);

    					els = document.querySelectorAll(hash);
        				
        				if (i > (els.length)) {
        					i = els.length - 1;
        				}
        				el = els[i];

        				var pos = position(el);
        				window.scrollTo(pos.left, pos.top);
        				highlight(el);
        			}
        		}
        	}

        	window.onload = function () {
        		scroll();
        		console.log(hasDefault());
        	}
        </script>
    </body>
</html>